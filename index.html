<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<!-- **** H E A D **** -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>My ai webapp</title>

	<style>
        #div2 {
            background-color: rgb(255, 255, 255);
            height: 40px;
            justify-content: center;
        }
        #div3 {
            text-align: center;
        }
        #div1 {
            display: flex;
            background-color: rgb(255, 255, 255);
            height: 40px;
            justify-content: center;
        }
        #btn1, #btn2 {
            bottom: 0;
            top: 0;
            margin: 10px;
        }
        #text1 {
            bottom: 0;
            top: 0;
            margin: 10px;
            
        }
        .textresult{
            margin-top: 30px;
            top: 0;
            border-style: solid;
            border-width: 1px;
            width: 100%;
            height: 600px;
            max-height: 1000px;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
        }
        #textarea1 {
            margin-top: 10px;
            font-size: large;
            padding-left: 10px;
            padding-top: 10px;
            padding-bottom: 10px;
            max-height: 45px;
            width: 100%;
            resize: none;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        p{
            justify-content: end;
            margin: 10px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        h1{
            text-align: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        #sendbtn {
            text-align: center;
            font-size: large;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
	</style>

	<script type="text/javascript">
        async function maj_btn() {
	    let prompt_text = document.getElementById("textarea1").value;
	    if (prompt_text.trim() === "") return;
	    // USER INPUT
	    document.getElementById("innertext").innerHTML += `<b>You:</b> ${prompt_text}<br>`;
	
	    document.getElementById("textarea1").value = "";

	    // REQUEST TO OLLAMA
	    try {
	        let response = await fetch("http://localhost:11434/api/generate", {
	            method: "POST",
	            headers: { "Content-Type": "application/json" },
	            body: JSON.stringify({
	                model: "mistral",
	                prompt: prompt_text,
	                stream: false
	            })
	        });
	
	        let data = await response.json();
	        let ai_response = data.response || "No response from AI";
	
            //AI RESP
	        document.getElementById("innertext").innerHTML += `<b>AI:</b> ${ai_response}<br><br>`;
	    } catch (error) {
	        console.error("Error fetching from Ollama:", error);
	        document.getElementById("innertext").innerHTML += `<b>AI:</b> Error: Could not connect to Ollama.<br>`;
	    }
	}
	</script>

</head>
<body>
<div id="div2">
    <h1>Disscuss with your local ai assistant</h1>
</div>
<div id = "div1" >
    <p>Server specs : Xeon E5 2670v3 12C 24T, 16Gb RAM, GTX 1660 6gb</p>
    
</div>
<div id="div2">
    <div class="textresult"><p id="innertext"></p></div>
    <textarea id="textarea1" placeholder="Explain clearly what you want." onkeyup="majbtn_pers()"></textarea>
    <div id="div3">
        <input id="sendbtn" type="button" value="Send prompt" onclick="maj_btn()">
    </div> 
</div>

</body>
</html>
